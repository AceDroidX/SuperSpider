import{V as _,u as h,_ as g}from"./VSnackbar.19134ee5.js";import{d as k,j as C,r as i,b as T,z as V,k as b,l as x,q as u,A as n,s as D,v as y,t as S,B,C as N}from"./entry.027c8510.js";import{V as F}from"./viewer-config.1cf8ab12.js";import"./variant.e807b8c9.js";const U=k({__name:"index",setup(L){const a=F(),d=N();C({title:"BiliSC",titleTemplate:`${a.room} - %s`});let t;const r=i([]),o=i(!1),s=i("Error");T(()=>m()),V(()=>a.startFetch,e=>{e?f():m()});async function f(){a.room&&(console.log("startFetchData"),await c(),t&&clearTimeout(t),p())}function p(){const e=async()=>{await c(),t=setTimeout(e,8e3)};t=setTimeout(e,8e3)}async function c(){if(!(!a.room||isNaN(Number(a.room))||a.room===""))try{const e=await h(d.public.BASE_API_URL+"/sc/getData",{method:"POST",body:`roomid=${a.room}&limit=${a.pageLimit}`,headers:{"Content-Type":"application/x-www-form-urlencoded"}},"$pqtWcjQkdb");r.value=e.data}catch(e){o.value=!0,e.response!==void 0&&e.response.data!==void 0?s.value=e.message+`
`+e.response.data:s.value=e.name+": "+e.message,console.warn(e)}}function m(){t&&clearTimeout(t),t=void 0,r.value=[]}return(e,l)=>{const v=g;return b(),x("div",null,[u(v,{rawscdata:n(r).value,showmarknative:n(a).showMarkNative},null,8,["rawscdata","showmarknative"]),u(_,{modelValue:n(o),"onUpdate:modelValue":l[0]||(l[0]=w=>B(o)?o.value=w:null)},{default:D(()=>[y(S(n(s)),1)]),_:1},8,["modelValue"])])}}});export{U as default};
