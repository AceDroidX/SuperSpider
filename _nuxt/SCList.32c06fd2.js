import l from"./SuperChat.312a1639.js";import{a as u,i as h,o as s,c as p,w as f,j as k,e as o,F as m,r as _,f as w}from"./entry.2cf9485d.js";import{V as g}from"./VContainer.64b1ec6b.js";import"./tag.7f81d670.js";const S={name:"SCList",props:{rawscdata:{type:Array,default:()=>[]},showmarknative:{type:Boolean,default:!1}},data(){return{scData:[],started:!1,db:void 0}},watch:{async rawscdata(t){await this.updateData(t)}},async mounted(){this.db=await h("BiliSC",void 0,{upgrade(t){console.log("upgrade"),t.createObjectStore("MarkState",{keyPath:"id"}).createIndex("id","id",{unique:!0})}})},methods:{async updateData(t){try{const e=t.slice();for(const[n,r]of e.entries())r.hide&&e.splice(n,1),this.showmarknative?r.markstate=await this.getMarkState(r.id):r.markstate=0;this.scData=e}catch(e){console.error(e)}},async changeMarkState(t){this.showmarknative&&(console.log("change state:"+t),this.db!==void 0&&(await this.getMarkState(t)===1?await this.deleteMarkState(t):await this.setMarkState(t,1),await this.updateData(this.rawscdata)))},async getMarkState(t){if(this.db===void 0)return;const e=await this.db.get("MarkState",t);return e?e.state:0},async deleteMarkState(t){this.db!==void 0&&await this.db.delete("MarkState",t)},async setMarkState(t,e){this.db!==void 0&&await this.db.put("MarkState",{id:t,state:e})}}},b={align:"center"};function y(t,e,n,r,i,c){const d=l;return s(),p(g,null,{default:f(()=>[k("div",b,[(s(!0),o(m,null,_(i.scData,a=>(s(),o("div",{key:a.id,style:{"margin-bottom":"20px"}},[w(d,{title:a.uname,price:Number(a.price),message:a.msg,messagejpn:"",avatar:a.avatar,uid:a.uid,contentcolor:a.bcolor,headercolor:a.pcolor,hiderate:!0,ts:a.ts,markstate:a.markstate,style:{"max-width":"700px"},align:"left",onClick:M=>c.changeMarkState(a.id)},null,8,["title","price","message","avatar","uid","contentcolor","headercolor","ts","markstate","onClick"])]))),128))])]),_:1})}const C=u(S,[["render",y]]);export{C as default};
