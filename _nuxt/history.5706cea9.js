import i from"./SCList.32c06fd2.js";import{a as n,m,b as h,o as c,e as d,f as s,w as l,h as f,t as u}from"./entry.2cf9485d.js";import{u as p,V as w}from"./VSnackbar.00f8e4b5.js";import"./SuperChat.312a1639.js";import"./VContainer.64b1ec6b.js";import"./tag.7f81d670.js";import"./router.295f1ffd.js";import"./color.f22f3f2e.js";import"./position.9ad51159.js";import"./forwardRefs.115f55a5.js";import"./transition.c1879f42.js";const T={data(){return{rawSCData:[],started:!1,timer:!1,addText:"",fontStyle:"",bgColor:"",bgColorList:["#304156","#473252","#00463f"],snackbar:!1,snackbarText:""}},head(){return{title:"BiliSC",titleTemplate:`${this.room} - %s`}},computed:{...m("HistoryViewerConfig",["room","showMarkNative","startFetch","startTS","endTS"])},watch:{startFetch(){this.startFetch&&this.startFetchData()}},async mounted(){this.bgColor=this.bgColorList[Math.floor(Math.random()*3)],this.$route.query.roomid&&this.room&&this.room!==""&&await this.startFetchData()},beforeDestroy(){this.timer&&clearTimeout(this.timer)},methods:{async startFetchData(){this.room&&(console.log("startFetchData"),await this.fetchData().catch(()=>{}),this.started!==this.room&&(this.timer&&clearTimeout(this.timer),this.setTimeoutLoop(),this.started=this.room))},setTimeoutLoop(){const t=async()=>{await this.fetchData().catch(()=>{}),this.timer=setTimeout(t,8e3)};this.timer=setTimeout(t,8e3)},async fetchData(){if(!(!this.room||isNaN(Number(this.room))||this.room===""))try{const t=h(),e=await p(t.BASE_API_URL+"/sc/getDataByTS",{method:"POST",body:`roomid=${this.room}&start=${this.startTS}&end=${this.endTS}`,headers:{"Content-Type":"application/x-www-form-urlencoded"}},"$N4P3RMRn2E");this.rawSCData=e.data}catch(t){this.snackbar=!0,t.response!==void 0?t.response.data!==void 0?this.snackbarText=t.message+`
`+t.response.data:this.snackbarText=t.name+": "+t.message:this.snackbarText=t.name+": "+t.message,console.warn(t)}}}};function b(t,e,k,S,a,y){const o=i;return c(),d("div",null,[s(o,{rawscdata:a.rawSCData,showmarknative:t.showMarkNative},null,8,["rawscdata","showmarknative"]),s(w,{modelValue:a.snackbar,"onUpdate:modelValue":e[0]||(e[0]=r=>a.snackbar=r)},{default:l(()=>[f(u(a.snackbarText),1)]),_:1},8,["modelValue"])])}const B=n(T,[["render",b]]);export{B as default};
