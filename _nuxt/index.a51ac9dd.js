import{V as _,u as h,_ as g}from"./VSnackbar.8c13c53e.js";import{d as k,r as i,b as T,y as C,j as V,k as b,m as l,z as n,q as x,s as y,t as D,A as S,B}from"./entry.e5a10ea8.js";import{u as N}from"./vue.f36acd1f.79073c76.js";import{V as F}from"./viewer-config.e92aff90.js";import"./variant.200e217a.js";const j=k({__name:"index",setup(L){const a=F(),d=B();N({title:"BiliSC",titleTemplate:`${a.room} - %s`});let t;const r=i([]),o=i(!1),s=i("Error");T(()=>c()),C(()=>a.startFetch,e=>{e?f():c()});async function f(){a.room&&(console.log("startFetchData"),await m(),t&&clearTimeout(t),p())}function p(){const e=async()=>{await m(),t=setTimeout(e,8e3)};t=setTimeout(e,8e3)}async function m(){if(!(!a.room||isNaN(Number(a.room))||a.room===""))try{const e=await h(d.public.BASE_API_URL+"/sc/getData",{method:"POST",body:`roomid=${a.room}&limit=${a.pageLimit}`,headers:{"Content-Type":"application/x-www-form-urlencoded"}},"$pqtWcjQkdb");r.value=e.data}catch(e){o.value=!0,e.response!==void 0&&e.response.data!==void 0?s.value=e.message+`
`+e.response.data:s.value=e.name+": "+e.message,console.warn(e)}}function c(){t&&clearTimeout(t),t=void 0,r.value=[]}return(e,u)=>{const v=g;return V(),b("div",null,[l(v,{rawscdata:n(r).value,showmarknative:n(a).showMarkNative},null,8,["rawscdata","showmarknative"]),l(_,{modelValue:n(o),"onUpdate:modelValue":u[0]||(u[0]=w=>S(o)?o.value=w:null)},{default:x(()=>[y(D(n(s)),1)]),_:1},8,["modelValue"])])}}});export{j as default};
