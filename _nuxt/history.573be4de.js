import i from"./SCList.366c74f1.js";import{a as n,m,b as h,o as c,e as d,f as s,w as f,h as l,t as u}from"./entry.2a47a7fd.js";import{u as p,V as w}from"./VSnackbar.f15a5e5c.js";import{H as T}from"./viewer-config.201ff265.js";import"./SuperChat.986072d9.js";import"./VContainer.437fac32.js";import"./tag.3dcb0d75.js";import"./router.ed83d862.js";import"./color.21b10d14.js";import"./position.5af7921d.js";import"./forwardRefs.064503a1.js";import"./transition.82b1bcf6.js";const b={data(){return{rawSCData:[],started:!1,timer:!1,addText:"",fontStyle:"",bgColor:"",bgColorList:["#304156","#473252","#00463f"],snackbar:!1,snackbarText:""}},head(){return{title:"BiliSC",titleTemplate:`${this.room} - %s`}},computed:{...m(T,["room","showMarkNative","startFetch","startTS","endTS"])},watch:{startFetch(){this.startFetch&&this.startFetchData()}},async mounted(){this.bgColor=this.bgColorList[Math.floor(Math.random()*3)],this.$route.query.roomid&&this.room&&this.room!==""&&await this.startFetchData()},beforeDestroy(){this.timer&&clearTimeout(this.timer)},methods:{async startFetchData(){this.room&&(console.log("startFetchData"),await this.fetchData().catch(()=>{}),this.started!==this.room&&(this.timer&&clearTimeout(this.timer),this.setTimeoutLoop(),this.started=this.room))},setTimeoutLoop(){const t=async()=>{await this.fetchData().catch(()=>{}),this.timer=setTimeout(t,8e3)};this.timer=setTimeout(t,8e3)},async fetchData(){if(!(!this.room||isNaN(Number(this.room))||this.room===""))try{const t=h(),e=await p(t.BASE_API_URL+"/sc/getDataByTS",{method:"POST",body:`roomid=${this.room}&start=${this.startTS}&end=${this.endTS}`,headers:{"Content-Type":"application/x-www-form-urlencoded"}},"$N4P3RMRn2E");this.rawSCData=e.data}catch(t){this.snackbar=!0,t.response!==void 0?t.response.data!==void 0?this.snackbarText=t.message+`
`+t.response.data:this.snackbarText=t.name+": "+t.message:this.snackbarText=t.name+": "+t.message,console.warn(t)}}}};function k(t,e,S,y,a,C){const o=i;return c(),d("div",null,[s(o,{rawscdata:a.rawSCData,showmarknative:t.showMarkNative},null,8,["rawscdata","showmarknative"]),s(w,{modelValue:a.snackbar,"onUpdate:modelValue":e[0]||(e[0]=r=>a.snackbar=r)},{default:f(()=>[l(u(a.snackbarText),1)]),_:1},8,["modelValue"])])}const R=n(b,[["render",k]]);export{R as default};
