import r from"./SCList.32c06fd2.js";import{a as n,m,b as c,o as h,e as l,f as s,w as p,h as f,t as u}from"./entry.2cf9485d.js";import{u as d,V as w}from"./VSnackbar.00f8e4b5.js";import"./SuperChat.312a1639.js";import"./VContainer.64b1ec6b.js";import"./tag.7f81d670.js";import"./router.295f1ffd.js";import"./color.f22f3f2e.js";import"./position.9ad51159.js";import"./forwardRefs.115f55a5.js";import"./transition.c1879f42.js";const k={data(){return{rawSCData:[],timer:!1,addText:"",fontStyle:"",snackbar:!1,snackbarText:"Error"}},head(){return{title:"BiliSC",titleTemplate:`${this.room} - %s`}},computed:{...m("ViewerConfig",["room","pageLimit","showMarkNative","startFetch"])},watch:{startFetch(){this.startFetch?this.startFetchData():this.stopFetchData()},snackbarText(t,e){console.log(t,e)},snackbar(t,e){console.log(t,e)}},async mounted(){},beforeDestroy(){this.stopFetchData()},methods:{async startFetchData(){this.room&&(console.log("startFetchData"),await this.fetchData(),this.timer&&clearTimeout(this.timer),this.setTimeoutLoop())},setTimeoutLoop(){const t=async()=>{await this.fetchData(),this.timer=setTimeout(t,8e3)};this.timer=setTimeout(t,8e3)},async fetchData(){if(!(!this.room||isNaN(Number(this.room))||this.room===""))try{const t=c(),e=await d(t.BASE_API_URL+"/sc/getData",{method:"POST",body:`roomid=${this.room}&limit=${this.pageLimit}${this.giftFilterNative?"&filter=on":""}`,headers:{"Content-Type":"application/x-www-form-urlencoded"}},"$PslAyef5YX");this.rawSCData=e.data}catch(t){this.snackbar=!0,t.response!==void 0?t.response.data!==void 0?this.snackbarText=t.message+`
`+t.response.data:this.snackbarText=t.name+": "+t.message:this.snackbarText=t.name+": "+t.message,console.warn(t)}},stopFetchData(){this.timer&&clearTimeout(this.timer),this.timer=!1,this.rawSCData=[]}}};function D(t,e,T,b,a,g){const o=r;return h(),l("div",null,[s(o,{rawscdata:a.rawSCData,showmarknative:t.showMarkNative},null,8,["rawscdata","showmarknative"]),s(w,{modelValue:a.snackbar,"onUpdate:modelValue":e[0]||(e[0]=i=>a.snackbar=i)},{default:p(()=>[f(u(a.snackbarText),1)]),_:1},8,["modelValue"])])}const B=n(k,[["render",D]]);export{B as default};
